Sub SendEmail()
    Dim AutomationPath As String
    Dim TrelloEmail As String
    
    AutomationPath = ""
    TrelloEmail = ""
    
    ExportSelectionToCSV AutomationPath
    ExecuteAutomationExe AutomationPath, TrelloEmail
End Sub


Sub ExportSelectionToCSV(AutomationPath)

    ' Declarar variáveis
    Dim SelectedRange As Range
    Dim FilePath As String
    Dim Cell As Range
    Dim RowData As String
    Dim FileNum As Integer
    
    ' Definir o intervalo selecionado
    Set SelectedRange = Selection
    
    FilePath = AutomationPath & "\excel_automation.csv"

    ' Abrir o arquivo para gravação
    FileNum = FreeFile
    Open FilePath For Output As FileNum
    
    ' Iterar sobre cada linha do intervalo selecionado
    For Each Row In SelectedRange.Rows
        RowData = ""
        ' Iterar sobre cada célula na linha
        For Each Cell In Row.Cells
            RowData = RowData & Cell.Value & ";"
        Next Cell
        ' Remover o último ponto e vírgule e escrever a linha no arquivo
        RowData = Left(RowData, Len(RowData) - 1)
        Print #FileNum, RowData
    Next Row
    
    ' Fechar o arquivo
    Close FileNum
    
    ' Notificar o usuário que o arquivo foi criado
    MsgBox "Arquivo CSV criado com sucesso!", vbInformation

End Sub

Sub ExecuteAutomationExe(AutomationFolderPath, TrelloEmail)
    Dim Args As String
    Dim AutomationExePath As String
    Dim AutomationWithArgs As String
    
    AutomationExePath = AutomationFolderPath & "\trello-excel-automation.exe"
    CsvPath = AutomationFolderPath & "\excel_automation.csv"
    
    ' Args Example = " -s {sender_email} -p {email_password} -r " & TrelloEmail & " -f " & CsvPath
    
    AutomationWithArgs = AutomationExePath & Args
    
    Call Shell(AutomationWithArgs, vbNormalFocus)
End Sub